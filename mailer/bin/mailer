#!/usr/bin/env ruby

require_relative '../config/setup'

require 'mailer/env'

require 'mail'
Mail.defaults do
  delivery_method(
    :smtp,
    address: "smtp.gmail.com",
    port: 587,
    user_name: Mailer::Env.gmail_username,
    password: Mailer::Env.gmail_password,
    authentication: 'plain',
    enable_starttls_auto: true
  )
end

require 'mailer/workers/user_workers/confirmation_worker'
workers = [
  Workers::UserWorkers::ConfirmationWorker
]

require 'sneakers/runner'
require 'logger'
Sneakers.configure amqp: Mailer::Env.amqp_url, daemonize: false, log: STDOUT
Sneakers.logger.level = Logger::INFO
Sneakers::Runner.new(workers).run

require 'awesome_print'
